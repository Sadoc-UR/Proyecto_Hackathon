<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../../IMG/LogoQ.png">
    <title>Chatbot de Seguridad</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #a1caff, #1677d1);
            color: white;
            text-align: center;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        /* Navbar */
        .circle-menu {
            background: linear-gradient(to right, #1e88e5, #1565c0);
            padding: 10px;
            width: 100%;
            display: flex;
            justify-content: flex-start;
        }

        .circle-item {
            background: transparent;
            color: white;
            font-weight: bold;
            font-size: 16px;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 10px;
            padding: 10px 15px;
            border: none;
            display: flex;
            align-items: center;
            gap: 5px;
            text-decoration: none;
        }

        .circle-item:hover {
            background-color: rgba(13, 56, 96, 0.2);
        }

        /* Chatbot */
        .chat-container {
            background: white;
            color: black;
            width: 90%;
            max-width: 600px;
            height: 80vh;
            display: flex;
            flex-direction: column;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        .chat-header {
            background: #1677d1;
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
        }

        .chat-body {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .chat-footer {
            display: flex;
            padding: 10px;
            border-top: 1px solid #ccc;
            background: #f9f9f9;
        }

        .chat-footer input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .chat-footer button {
            background: #1677d1;
            color: white;
            border: none;
            padding: 10px;
            margin-left: 5px;
            border-radius: 5px;
            cursor: pointer;
        }

        .user-message, .bot-message {
            margin: 5px 0;
            padding: 10px;
            border-radius: 10px;
            max-width: 80%;
        }

        .user-message {
            background: #1677d1;
            color: white;
            align-self: flex-end;
            text-align: right;
        }

        .bot-message {
            background: #f1f1f1;
            color: black;
            align-self: flex-start;
            text-align: left;
        }

        /* Footer */
        footer {
            width: 100%;
            background: linear-gradient(to right, #1e88e5, #1565c0);
            color: white;
            text-align: center;
            padding: 20px 10px;
            margin-top: 20px;
        }

        footer a {
            color: black;
            font-weight: bold;
            transition: color 0.3s;
        }

        footer a:hover {
            color: yellow;
        }

    </style>
</head>
<body>

        <!-- Navbar -->
        <nav class="fixed top-0 left-0 w-full bg-gradient-to-r from-sky-400 to-blue-600 shadow-md py-3 px-6 flex justify-between items-center text-white">
            <div class="font-bold text-xl flex items-center">
                <div class="">
                    <img src="../../../IMG/LogQRO-removebg-preview.png" alt="Logo" class="h-20 w-15 object-contain">
                </div>
                <span class="ml-20 text-lg">Denuncias Ciudadanas</span>
            </div>
            <ul class="hidden md:flex space-x-6 items-center">
                <li>
                    <a href="../Index.html" class="inline-flex items-center px-4 py-2 gap-2 hover:bg-yellow-400 hover:text-blue-900 rounded-lg transition-all focus:outline-none">
                        <img src="../../../IMG/home.png" alt="Inicio" class="h-8 w-8"> <span>Inicio</span>
                    </a>
                </li>
                <li>
                    <a href="Formularios/Nosotros.html" class="inline-flex items-center px-4 py-2 gap-2 hover:bg-yellow-400 hover:text-blue-900 rounded-lg transition-all focus:outline-none">
                        <img src="../../../IMG/group_24dp_E3E3E3_FILL0_wght400_GRAD0_opsz24.png" class="h-8 w-8"> <span>Sobre Nosotros</span>
                    </a>
                </li>
                <li>
                    <a href="Formularios/Preguntas.html" class="inline-flex items-center px-4 py-2 gap-2 hover:bg-yellow-400 hover:text-blue-900 rounded-lg transition-all focus:outline-none">
                        <img src="../../../IMG/help_24dp_E3E3E3_FILL0_wght400_GRAD0_opsz24.png" alt="FAQ" class="h-8 w-8"> <span>FAQ</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="inline-flex items-center px-4 py-2 gap-2 hover:bg-yellow-400 hover:text-blue-900 rounded-lg transition-all focus:outline-none">
                        <img src="../../../IMG/rename.png" alt="Contacto" class="h-8 w-8"> <span>Contacto</span>
                    </a>
                </li>
            </ul>
        </nav>
        
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>

    <!-- Contenedor del Chat -->
    <div class="chat-container">
        <div class="chat-header">Asistente Virtual de Seguridad</div>
        <div class="chat-body" id="chat-body"></div>
        <div class="chat-footer">
            <input type="text" id="chat-input" placeholder="Escribe aqu铆..." onkeypress="handleKeyPress(event)">
            <button onclick="sendMessage()">Enviar</button>
        </div>
    </div>
    <br>
    <br>
    <br>

    <!-- Footer -->
    <footer class="w-full bg-gradient-to-r from-sky-400 to-blue-600 text-white py-8 mt-12 text-center">
        <div class="container mx-auto px-6">
            <div class="flex flex-wrap justify-center gap-8 mb-6">
                <div>
                    <h4 class="font-bold text-lg mb-2 text-black"><i class="fas fa-map-marker-alt"></i> Direcci贸n</h4>
                    <p class="text-gray-300">Av. Ciudadana #123, Ciudad, Pa铆s</p>
                </div>
                <div>
                    <h4 class="font-bold text-lg mb-2 text-black"><i class="fas fa-envelope"></i> Contacto</h4>
                    <p class="text-gray-300">soporte@denunciasciudadanas.com</p>
                </div>
                <div>
                    <h4 class="font-bold text-lg mb-2 text-black"><i class="fas fa-phone"></i> Tel茅fono</h4>
                    <p class="text-gray-300">+123 456 7890</p>
                </div>
            </div>
            
            <div class="border-t border-gray-600 pt-4">
                <p class="text-gray-300">&copy; 2025 Denuncias Ciudadanas | Todos los derechos reservados.</p>
                <div class="flex justify-center space-x-6 mt-3">
                    <a href="#" class="text-gray-400 hover:text-yellow-300 transition"><i class="fab fa-facebook-f text-xl"></i></a>
                    <a href="#" class="text-gray-400 hover:text-yellow-300 transition"><i class="fab fa-twitter text-xl"></i></a>
                    <a href="#" class="text-gray-400 hover:text-yellow-300 transition"><i class="fab fa-instagram text-xl"></i></a>
                    <a href="#" class="text-gray-400 hover:text-yellow-300 transition"><i class="fab fa-linkedin-in text-xl"></i></a>
                </div>
                <div class="mt-4">
                    <a href="#" class="text-black hover:text-yellow-300 transition text-sm"><i class="fas fa-file-contract"></i> T茅rminos y Condiciones</a> |
                    <a href="#" class="text-black hover:text-yellow-300 transition text-sm"><i class="fas fa-user-shield"></i> Pol铆tica de Privacidad</a>
                </div>
            </div>
        </div>
    </footer>

   
    <script>
        function sendMessage() {
            const input = document.getElementById("chat-input");
            const chatBody = document.getElementById("chat-body");
            let userMessage = input.value.trim();
    
            if (userMessage === "") return;
    
            // Mostrar mensaje del usuario
            const userDiv = document.createElement("div");
            userDiv.className = "user-message";
            userDiv.textContent = userMessage;
            chatBody.appendChild(userDiv);
            chatBody.scrollTop = chatBody.scrollHeight;
            input.value = "";
    
            // Respuesta del bot
            setTimeout(() => {
                const botResponse = getBotResponse(userMessage);
                const botDiv = document.createElement("div");
                botDiv.className = "bot-message";
                botDiv.innerHTML = botResponse;
                chatBody.appendChild(botDiv);
                chatBody.scrollTop = chatBody.scrollHeight;
            }, 1000);
        }
    
        function handleKeyPress(event) {
            if (event.key === "Enter") {
                sendMessage();
            }
        }
    
        function getBotResponse(message) {
            message = correctSpelling(message.toLowerCase());
    
            // Categor铆as de emergencias con palabras clave mejoradas
            const emergencies = {
        "general": [
            "ayuda", "socorro", "emergencia", "auxilio", "urgencia",
            "necesito ayuda", "alguien me ayuda", "por favor ayuda",
            "peligro", "rescate", "necesito asistencia", "auxilio por favor"
        ],
        "ambulancia": [
            "ambulancia", "patrulla", "desmayo", "sangre", "dolor", "ataque", 
            "paro", "ahogo", "intoxicaci贸n", "electrocuci贸n", "muerte", "muerto",
            "herida", "fractura", "convulsi贸n", "quemadura", "emorragia",
            "choque", "infarto", "accidente", "presi贸n baja", "presi贸n alta",
            "diabetes", "deshidrataci贸n", "asfixia", "ahogamiento", "falta de aire",
            "comida atorada", "veneno", "sobredosis", "medicamento equivocado",
            "desmayo repentino", "coraz贸n acelerado", "latidos irregulares",
            "golpe fuerte", "perdida de conocimiento", "dolor de cabeza intenso",
            "visi贸n borrosa", "piernas dormidas", "no siento mi brazo"
        ],
        "bomberos": [
            "incendio", "humo", "quemar", "explosi贸n", "fuego", "llamas", 
            "chispa", "corto circuito", "gas", "fuga de gas", "olor a gas",
            "quema de basura", "prendi贸 fuego", "gasolina", "estufa explot贸",
            "candela", "hogar en llamas", "edificio en llamas", "alarma de incendio",
            "extintor no funciona", "tanque de gas", "carro en llamas",
            "electrodom茅stico explot贸", "cable quemado", "chispas en el techo",
            "calentador explot贸", "humo negro", "pared caliente", "ventanas rotas por fuego"
        ],
        "polic铆a": [
            "asalto", "robo", "violencia", "arma", "armas", "disparo", "balacera",
            "secuestro", "amenaza", "crimen", "terrorismo", "bomba", "narcotr谩fico",
            "vandalismo", "acoso", "intento de robo", "ladrones", "alguien sospechoso",
            "golpearon a alguien", "gritos en la calle", "pandilla", "fraude",
            "estafa", "me est谩n siguiendo", "me vigilan", "sospechoso en mi casa",
            "hombre con pistola", "arma blanca", "navaja", "pistola", "rev贸lver",
            "narcomenudeo", "venta de drogas", "cartel", "crimen organizado",
            "desaparici贸n", "personas encapuchadas", "se escucharon disparos",
            "saqueo", "desorden p煤blico", "pelea en la calle", "amenaza de bomba",
            "extorsi贸n", "llamadas amenazantes", "fraude bancario"
        ]
     };

            // Detectar tipo de emergencia
            for (const [type, keywords] of Object.entries(emergencies)) {
                if (containsKeyword(message, keywords)) {
                    getLocation(type);
                    return ` Emergencia detectada (${type.toUpperCase()}) <br>  Intentando obtener tu ubicaci贸n...`;
                }
            }
    
            return " No detecto una emergencia, pero dime en qu茅 puedo ayudarte.";
        }
    
        function containsKeyword(message, keywords) {
            return keywords.some(keyword => message.includes(keyword));
        }
    
        function correctSpelling(text) {
            const corrections = {
                "ayda": "ayuda", "aydua": "ayuda",
                "socoro": "socorro", "socro": "socorro",
                "polisia": "polic铆a", "polis": "polic铆a",
                "ambulansia": "ambulancia", "amblancia": "ambulancia",
                "insendio": "incendio", "encendio": "incendio",
                "azalto": "asalto", "asaltooo": "asalto",
                "emegencia": "emergencia", "emrgencia": "emergencia",
                "balacerra": "balacera",
                "aramas": "armas", "armass": "armas",
                "terrismo": "terrorismo",
                "boma": "bomba", "bombba": "bomba",
                "narotrafico": "narcotr谩fico",
                "sequestro": "secuestro",
                "disparoos": "disparo",
                "acidente": "accidente", "aksidente": "accidente",
                "urgncia": "urgencia",
                "intoxicasion": "intoxicaci贸n",
                "elektrocucion": "electrocuci贸n",
                "muerrte": "muerte", "muertte": "muerte",
                "patrula": "patrulla", "patrlla": "patrulla",
                "policia": "polic铆a", "bomveros": "bomberos"
            };
    
            for (const [wrong, correct] of Object.entries(corrections)) {
                text = text.replace(new RegExp(`\\b${wrong}\\b`, "gi"), correct);
            }
            return text;
        }
    
        function getLocation(service) {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(position => {
                    const latitude = position.coords.latitude;
                    const longitude = position.coords.longitude;
                    sendEmergencyAlert(latitude, longitude, service);
                }, error => {
                    console.log("No se pudo obtener la ubicaci贸n:", error);
                    alert("锔 No pudimos acceder a tu ubicaci贸n. Aseg煤rate de activar el GPS.");
                });
            } else {
                alert("锔 Tu navegador no soporta geolocalizaci贸n.");
            }
        }
    
        function sendEmergencyAlert(lat, lon, service) {
    const emergencyNumbers = {
        "general": "911", // N煤mero de emergencia general
        "ambulancia": "066", // Ambulancia en algunas regiones
        "bomberos": "068", // Bomberos en algunas regiones
        "polic铆a": "089", // Polic铆a en algunas regiones
        "cruz roja": "065", // Cruz Roja
        "protecci贸n civil": "074", // Protecci贸n Civil
        "guardia nacional": "088", // Guardia Nacional
        "tr谩nsito": "060", // Emergencias de tr谩fico
        "rescate": "075", // B煤squeda y rescate
        "gas": "800-999-8000", // Fuga de gas
        "electricidad": "071", // Fallas el茅ctricas
        "violencia dom茅stica": "800-108-4053", // L铆nea contra violencia de g茅nero
        "suicidio": "800-273-8255", // L铆nea de prevenci贸n del suicidio
        "secuestro": "089", // Denuncia de secuestro
        "fraude": "088", // Fraude y delitos cibern茅ticos
        "desastres naturales": "074", // Protecci贸n Civil en caso de desastres
        "maltrato infantil": "800-847-6473", // L铆nea de protecci贸n infantil
    };

    let number = emergencyNumbers[service] || "911";
    let mapLink = `https://www.google.com/maps?q=${lat},${lon}`;
    let message = ` Emergencia (${service.toUpperCase()}) <br>  <a href="${mapLink}" target="_blank">Ver ubicaci贸n en mapa</a> <br>  <a href="tel:${number}">Llamar al ${number}</a>`;

    setTimeout(() => {
        const chatBody = document.getElementById("chat-body");
        const botDiv = document.createElement("div");
        botDiv.className = "bot-message";
        botDiv.innerHTML = message;
        chatBody.appendChild(botDiv);
        chatBody.scrollTop = chatBody.scrollHeight;

        // Llamada autom谩tica al n煤mero de emergencia
        autoCall(number);
    }, 2000);
}

// Funci贸n para realizar la llamada autom谩ticamente
function autoCall(number) {
    setTimeout(() => {
        window.location.href = `tel:${number}`;
    }, 3000); // Espera 3 segundos antes de iniciar la llamada autom谩tica
}

        // Mensaje de bienvenida
        setTimeout(() => {
            const chatBody = document.getElementById("chat-body");
            const botDiv = document.createElement("div");
            botDiv.className = "bot-message";
            botDiv.innerHTML = " 隆Hola! Soy tu asistente de emergencias.<br>Si necesitas ayuda, dime qu茅 ocurre.";
            chatBody.appendChild(botDiv);
        }, 1000);
    </script>
    
</body>
</html>
